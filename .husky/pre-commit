#!/usr/bin/env sh

# Add common pnpm locations to PATH
export PATH="$PATH:/opt/homebrew/bin"
export PATH="$PATH:$HOME/.local/share/pnpm"
export PATH="$PATH:/usr/local/bin"

# Check lockfile before committing
if [ -f "pnpm-lock.yaml" ]; then
  if ! pnpm install --frozen-lockfile --silent 2>&1 | grep -q "ERR_PNPM_OUTDATED_LOCKFILE"; then
    echo "✅ Lockfile is up to date"
  else
    echo "❌ Lockfile is outdated!"
    echo "Run: pnpm install"
    echo "Then commit the updated pnpm-lock.yaml"
    exit 1
  fi
fi

npx lint-staged
